<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>reCAPTCHA v3 Demo</title>
    <script src="https://recaptcha.net/recaptcha/api.js?render=6LdQatYoAAAAAKh40dGK4oaa1uwvLIMROflBGvIL"></script>
</head>
<body>
    <h1>reCAPTCHA v3 Demo</h1>
    This page use <a href=https://workers.cloudflare.com/>CloudFlare Workers</a> as end point
    <br>
    
    <button id="getScoreButton">获取 reCAPTCHA 得分</button>
    <div id="scoreDisplay"></div> <!-- 用于显示得分 -->

    <script>
        document.getElementById('getScoreButton').addEventListener('click', function() {
            // 获取 reCAPTCHA token
            grecaptcha.execute('6LdQatYoAAAAAKh40dGK4oaa1uwvLIMROflBGvIL', {action: 'submit'}).then(function(token) {
                // 发送 token 到 Cloudflare Workers 进行验证
                fetch('https://recaptchafunctions.itman-terminal.workers.dev/verify', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ token: token })
                })
                .then(response => response.json())
                .then(data => {
                    // 显示得分
                    document.getElementById('scoreDisplay').innerText = '得分: ' + data.score;
                })
                .catch(error => {
                    console.error('Error:', error);
                });
            });
        });
    </script>
</body>
</html>
